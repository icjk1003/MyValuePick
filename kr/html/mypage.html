<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>마이페이지 · MyValuePick</title>
  <link rel="stylesheet" href="../shared/css/common.css">
  <link rel="stylesheet" href="../shared/css/mypage.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css" />
</head>
<body>

  <div id="global-header"></div>

  <main class="mypage-wrap">
    <div class="mypage-container">
      
      <aside class="mypage-sidebar card">
        <div class="profile-summary">
            <div class="profile-img-area">
                <label for="profileUpload" class="profile-upload-label">
                    <img src="" id="myProfileImg" alt="프로필">
                    <div class="profile-overlay">
                        <span>📷<br>사진 변경</span>
                    </div>
                </label>
                <input type="file" id="profileUpload" accept="image/*" class="file-input-hidden">
            </div>

          <h3 id="myNickDisplay">닉네임 로딩중</h3>
          <p id="myEmailDisplay" style="word-break: break-all; color: var(--muted); font-size: 13px;">user@email.com</p>
        </div>
        
        <nav class="mypage-menu">
          <a href="javascript:void(0)" onclick="showMypageSection('edit')" id="menu-edit" class="active">⚙️ 내 정보 관리</a>
          <a href="javascript:void(0)" onclick="showMypageSection('posts')" id="menu-posts">📝 내가 쓴 글</a>
          <a href="javascript:void(0)" onclick="showMypageSection('comments')" id="menu-comments">💬 내가 쓴 댓글</a>
          <a href="javascript:void(0)" onclick="showMypageSection('social')" id="menu-social">🔗 계정 연동</a>
          
          <div class="menu-sep"></div>
          <a href="#" onclick="logout()" class="menu-logout">로그아웃</a>
        </nav>
      </aside>

      <section id="section-edit" class="mypage-content card">
        <h2 class="section-title">내 정보 관리</h2>
        
        <div class="form-row">
          <label>이메일</label>
          <input type="email" id="myEmailInput" class="input-readonly" readonly>
          <p class="desc">이메일은 변경할 수 없습니다.</p>
        </div>

        <div class="form-row">
          <label>닉네임</label>
          <input type="text" id="myNickInput" class="input-edit" placeholder="닉네임을 입력하세요">
          <p id="nickCheckMsg" style="font-size:12px; font-weight:600; margin-top:4px; min-height:18px;"></p>
        </div>

        <div class="form-row">
          <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
            <label style="margin-bottom:0;">자기소개</label>
            <div class="bio-btn-group">
              <button id="btnEditBio" class="btn-text-action">수정</button>
              <button id="btnSaveBio" class="btn-text-action primary hidden">저장</button>
              <button id="btnCancelBio" class="btn-text-action bad hidden">취소</button>
            </div>
          </div>
          <textarea id="myBioInput" class="input-bio input-readonly" readonly></textarea>
        </div>

        <div class="form-row">
          <label>비밀번호 변경</label>
          <input type="password" id="myPwInput" class="input-edit" placeholder="새 비밀번호 (변경시에만 입력)">
          <input type="password" id="myPwCheckInput" class="input-edit input-gap-top" placeholder="새 비밀번호 확인">
          <p id="pwCheckMsg" class="msg-mini"></p>
        </div>
        <div class="btn-area">

        <div class="btn-area">
          <button id="btnSaveMyInfo" class="btn-save">변경사항 저장</button>
        </div>

        <div class="withdrawal-area">
          <span class="withdrawal-desc">더 이상 서비스를 이용하지 않으시려면</span>
          <button id="btnWithdrawal" class="btn-text-action bad">회원 탈퇴</button>
        </div>
      </section>

      <section id="section-posts" class="mypage-content card hidden">
        <h2 class="section-title">내가 쓴 글</h2>
        <div id="myPostsList" class="my-content-list"></div>
      </section>

      <section id="section-comments" class="mypage-content card hidden">
        <h2 class="section-title">내가 쓴 댓글</h2>
        <div id="myCommentsList" class="my-content-list"></div>
      </section>

      <section id="section-social" class="mypage-content card hidden">
        <h2 class="section-title">계정 연동 관리</h2>
        <p class="desc" style="margin-bottom: 30px;">
            자주 사용하는 소셜 계정을 연동하여 간편하게 로그인할 수 있습니다.<br>
            연동을 해제하면 해당 계정으로는 더 이상 로그인할 수 없습니다.
        </p>
        
        <div class="social-link-list">
            <div class="social-item">
                <div class="social-info">
                    <div class="social-icon google">G</div>
                    <div class="social-text">
                        <div class="name">Google</div>
                        <div class="status" id="status-google">연동 안됨</div>
                    </div>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="toggle-google" onchange="toggleSocial('google')">
                    <span class="slider"></span>
                </label>
            </div>

            <div class="social-item">
                <div class="social-info">
                    <div class="social-icon naver">N</div>
                    <div class="social-text">
                        <div class="name">Naver</div>
                        <div class="status" id="status-naver">연동 안됨</div>
                    </div>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="toggle-naver" onchange="toggleSocial('naver')">
                    <span class="slider"></span>
                </label>
            </div>

            <div class="social-item">
                <div class="social-info">
                    <div class="social-icon kakao">K</div>
                    <div class="social-text">
                        <div class="name">Kakao</div>
                        <div class="status" id="status-kakao">연동 안됨</div>
                    </div>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="toggle-kakao" onchange="toggleSocial('kakao')">
                    <span class="slider"></span>
                </label>
            </div>

            <div class="social-item">
                <div class="social-info">
                    <div class="social-icon apple">A</div>
                    <div class="social-text">
                        <div class="name">Apple</div>
                        <div class="status" id="status-apple">연동 안됨</div>
                    </div>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="toggle-apple" onchange="toggleSocial('apple')">
                    <span class="slider"></span>
                </label>
            </div>
        </div>
      </section>

    </div>
  </main>

  <div id="cropModal" class="modal-overlay hidden">
    <div class="crop-container">
      <h3>프로필 사진 자르기</h3>
      <div class="crop-area">
        <img id="imageToCrop" src="" alt="자르기 할 이미지">
      </div>
      <div class="crop-btns">
        <button id="btnCropCancel" class="btn-text-action bad">취소</button>
        <button id="btnCropConfirm" class="btn primary">적용하기</button>
      </div>
    </div>
  </div>

  <div id="global-footer"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>
  <script src="../shared/js/common.js"></script>
  <script src="../shared/js/mypage.js"></script>
</body>
</html>